{% extends 'base.html' %}

{% block header %}

{% endblock %}

{% block body %}
<div class="container">
    {% with messages = get_flashed_messages() %}
    {% if messages %}
    <div class="flash-overlay" id="flashMessage">
        {% for message in messages %}
        <div class="flash-text">{{ message }}</div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Chat Box -->
    <h1 style="text-align: center; color: rgb(10, 10, 10)">
        â‹†ï½¡ï¾Ÿ <span style="color: #faf7f7;font-family: 'Courier New', Courier, monospace">WALL-E</span> ï½¡â˜¾
    </h1>

    <!-- Chat Box -->
    <div class="chat-box" id="chatBox">
        {% if history %}
        {% for q, a in history %}
        {% if q %}
        <div class="message user">{{ q }}</div>
        {% endif %}
        {% if a %}
        <div class="message bot">{{ a }}</div>
        {% endif %}
        {% endfor %}
        {% endif %}
    </div>
    <!-- Form -->
    <form method="POST" enctype="multipart/form-data" id="chatForm">
        <div class="input-container">
            <input type="text" id="question" name="question" placeholder="Ask anything" autocomplete="off">

            <!-- Attach PDF Button -->
            <label for="doc-upload" class="attach-button">ðŸ“Ž Attach</label>
            <input type="file" id="doc-upload" name="doc_file" hidden>

            <!-- Send Button -->
            <button type="submit" class="submit-button">Send</button>
        </div>
    </form>

</div>


<!-- JS to auto-fade flash message -->
<script>
    window.addEventListener("DOMContentLoaded", function () {
        const flash = document.getElementById("flashMessage");
        if (flash) {
            setTimeout(() => {
                flash.style.opacity = "0";
                setTimeout(() => flash.remove(), 1000); // remove from DOM after fade
            }, 3000);
        }
    });
</script>

{% endblock %}